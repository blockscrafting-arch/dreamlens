# Инструкция по настройке базы данных Supabase

## Быстрый старт

1. Откройте [Supabase Dashboard](https://supabase.com/dashboard)
2. Перейдите в ваш проект
3. Откройте **SQL Editor** (в левом меню)
4. Скопируйте весь содержимое файла `schema-supabase.sql`
5. Вставьте в SQL Editor
6. Нажмите **Run** или выполните запрос (Ctrl+Enter)

**Важно:** Используйте обновленную версию `schema-supabase.sql` (исправлена ошибка с частичным уникальным индексом)

## Проверка

После выполнения схемы проверьте, что все таблицы созданы:

1. Перейдите в **Table Editor** (в левом меню)
2. Должны быть видны следующие таблицы:
   - `users`
   - `subscriptions`
   - `generations`
   - `usage_logs`
   - `payments`
   - `user_tokens`
   - `token_transactions`

## Важно

- ✅ Используйте файл `schema-supabase.sql` (без комментариев)
- ❌ НЕ используйте `schema.sql` (содержит комментарии, которые Supabase SQL Editor не принимает)
- ✅ Все переменные окружения (`POSTGRES_URL`, `POSTGRES_PRISMA_URL`, `POSTGRES_URL_NON_POOLING`) уже установлены Vercel автоматически
- ✅ Код использует `@vercel/postgres`, который совместим с Supabase "из коробки"

## Если возникли ошибки

### Ошибка "relation does not exist"
- Убедитесь, что вы выполнили весь SQL скрипт целиком
- Проверьте, что все таблицы созданы в Table Editor

### Ошибка синтаксиса
- Убедитесь, что используете `schema-supabase.sql` (без комментариев)
- Проверьте, что скопировали весь файл целиком

### Ошибка подключения к базе данных
- Проверьте, что переменные окружения установлены в Vercel Dashboard
- Убедитесь, что Supabase проект активен и доступен

